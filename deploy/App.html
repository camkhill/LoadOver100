<!DOCTYPE html>
<html>
<head>
    <title>LoadOver100App</title>

    <script type="text/javascript" src="/apps/2.0/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.TimeboxScopedApp",scopeType:"iteration",onScopeChange:function(scope){},componentCls:"app",launch:function(){console.log("about to load"),Ext.create("Rally.data.wsapi.Store",{model:"User Iteration Capacity",fetch:["User","Capacity","TaskEstimates","Load","Project","Iteration"],autoLoad:!0,listeners:{load:this._loadData,scope:this}})},_loadData:function(store,data){var records=[],iterationID,capacity,taskEstimate,load,recordCounter=0;console.log("Record Counter",recordCounter),console.log("Iteration ID",iterationID),Ext.Array.each(data,function(record){if(load=record.get("Load"),iteration=record.get("Iteration")._refObjectName,load>1){records.push({User:record.get("User")._refObjectName,Capacity:record.get("Capacity"),TaskEstimate:record.get("TaskEstimates"),Load:record.get("Load"),Project:record.get("Project")._refObjectName,Iteration:record.get("Iteration")._refObjectName});var username=record.get("Iteration");console.log("User",username)}recordCounter++,console.log("Record Counter",recordCounter)}),this.add({xtype:"rallygrid",store:Ext.create("Rally.data.custom.Store",{data:records}),columnCfgs:[{text:"User",dataIndex:"User"},{text:"Load",dataIndex:"Load"},{text:"Capacity",dataIndex:"Capacity"},{text:"Project",dataIndex:"Project"},{text:"Iteration",dataIndex:"Iteration"}]}),console.log("Fetched Data")}});

            Rally.launchApp('CustomApp', {
                name:"LoadOver100App",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
